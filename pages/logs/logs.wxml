<!-- index.wxml -->
<view class="container">
  <!-- å›ºå®šåœ¨é¡¶éƒ¨çš„æœç´¢æ  -->
  <view class="search-bar">
    <input 
      class="search-input" 
      placeholder="è¾“å…¥å¤è¯—æ–‡å…³é”®è¯..." 
      bindinput="onInput" 
      value="{{searchKeyword}}"
      bindconfirm="doSearch"
    />
    <button class="search-btn" bindtap="doSearch">æœç´¢</button>
  </view>
  
  <!-- å†…å®¹åŒºåŸŸ - ç´§è´´æœç´¢æ  -->
  <scroll-view 
    class="result-list" 
    scroll-y="true"
    scroll-with-animation="true"
    enable-back-to-top="true"
  >
    <!-- é¡¶éƒ¨å ä½ç¬¦ - ç¡®ä¿å†…å®¹ä»æœç´¢æ ä¸‹æ–¹å¼€å§‹ -->
    <view class="top-spacer"></view>
    
    <block wx:if="{{!loading}}">
      <block wx:if="{{totalCount === 0}}">
        <view class="empty-result">
          <view class="empty-text">
            {{hasSearched ? 'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¤è¯—æ–‡' : 'æš‚æ— å¤è¯—æ–‡æ•°æ®'}}
          </view>
          <view class="empty-tip">
            {{hasSearched ? 'è¯·å°è¯•ä¸åŒçš„å…³é”®è¯' : ''}}
          </view>
        </view>
      </block>
      
      <block wx:else>
        <view class="search-header">
          <view class="result-count">
            {{hasSearched ? 'æ‰¾åˆ° ' + totalCount + ' æ¡åŒ¹é…ç»“æœ' : 'å…± ' + totalCount + ' æ¡'}}
          </view>
        </view>
        
        <block wx:for="{{searchResults}}" wx:key="id">
          <view 
            class="result-card" 
            bindtap="navigateToDetail"
            data-item="{{item}}"  
            data-id="{{item.id}}" 
            data-index="{{index}}" 
          >
            <text class="title">{{item.title}}</text>
            <view class="info-row">
              <text class="author">ä½œè€…: {{item.author || 'æœªçŸ¥'}}</text>
              <text class="dynasty">{{item.dynasty || 'ä¸è¯¦'}}</text>
            </view>
            <text class="content">{{item.content || item.description}}</text>
          </view>
        </block>
      </block>
    </block>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <!-- åº•éƒ¨å ä½ç¬¦ - ç¡®ä¿å†…å®¹ä¸è¢«åˆ†é¡µæ é®æŒ¡ -->
    <view class="bottom-spacer"></view>
  </scroll-view>
  
  <!-- å›ºå®šåœ¨åº•éƒ¨çš„åˆ†é¡µæ  -->
  <view class="pagination-container" wx:if="{{totalCount > 0}}">
    <text class="total-count">æ€»è®¡ {{totalCount}}</text>
    
    <view class="pagination-controls">
      <!-- å·¦ç®­å¤´ -->
      <view 
        class="pagination-arrow {{currentPage === 1 ? 'disabled' : ''}}" 
        bindtap="goToPrevPage"
      >
        <image src="https://newlan.oss-cn-shanghai.aliyuncs.com/icons/%E5%B7%A6%E7%AE%AD%E5%A4%B4.jpg" class="arrow-icon" mode="aspectFit" />
      </view>
      
      <!-- å½“å‰é¡µç æ˜¾ç¤º -->
      <view class="page-current-container">
        <text>{{currentPage}}</text>
      </view>
      
      <!-- å³ç®­å¤´ -->
      <view 
        class="pagination-arrow {{currentPage === totalPages ? 'disabled' : ''}}" 
        bindtap="goToNextPage"
      >
        <image src="https://newlan.oss-cn-shanghai.aliyuncs.com/icons/%E5%8F%B3%E7%AE%AD%E5%A4%B4.jpg" class="arrow-icon" mode="aspectFit" />
      </view>
      
      <!-- è½¬åˆ°åŒºåŸŸ -->
      <view class="goto-group">
        <text class="goto-label">è½¬åˆ°</text>
        <input 
          class="goto-input" 
          type="number" 
          placeholder="é¡µç " 
          value="{{gotoPage}}"
          bindinput="onGotoInput"
        />
      </view>
      
      <!-- è·³è½¬æŒ‰é’® -->
      <button class="goto-button" bindtap="goToSpecifiedPage">è·³è½¬</button>
    </view>
  </view>
</view>

<!-- åœ¨æ–‡ä»¶åº•éƒ¨æ·»åŠ  -->
<view class="float-nav-tool" bindtap="navigateToIndex">
  <text class="float-nav-icon">ğŸ </text>
</view>