<view class="container">
  <!-- å›ºå®šåœ¨é¡¶éƒ¨çš„æœç´¢æ  -->
  <view class="search-bar">
    <input 
      class="search-input" 
      placeholder="è¾“å…¥å¤è¯—æ–‡å…³é”®è¯..." 
      bindinput="onKeywordInput" 
      value="{{searchKeyword}}"
      bindconfirm="doSearch"
    />
    <button class="search-btn" bindtap="doSearch">æœç´¢</button>
  </view>
  
  <!-- æœä»£é€‰æ‹©å™¨ -->
  <view class="dynasty-selector">
    <picker 
      range="{{dynastyList}}" 
      range-key="dynasty" 
      value="{{dynastyIndex}}"
      bindchange="onDynastyChange">
      <view class="picker">
        å½“å‰æœä»£: {{dynastyList[dynastyIndex] ? dynastyList[dynastyIndex].dynasty : 'å…¨éƒ¨'}}
      </view>
    </picker>
  </view>
  
  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view 
    class="result-list" 
    scroll-y="true"
    scroll-with-animation="true"
    enable-back-to-top="true"
  >
    <view class="top-spacer"></view>
    
    <block wx:if="{{!loading}}">
      <block wx:if="{{totalCount === 0}}">
        <view class="empty-result">
          <view class="empty-text">
            {{hasSearched ? 'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¤è¯—' : 'æš‚æ— å¤è¯—æ•°æ®'}}
          </view>
          <view class="empty-tip">
            {{hasSearched ? 'è¯·å°è¯•ä¸åŒçš„å…³é”®è¯æˆ–æœä»£' : ''}}
          </view>
        </view>
      </block>
      
      <block wx:else>
        <view class="search-header">
          <view class="result-count">
            {{hasSearched ? 'æ‰¾åˆ° ' + totalCount + ' æ¡åŒ¹é…ç»“æœ' : (selectedDynastyId ? dynastyList[dynastyIndex].dynasty + ' ' + totalCount + ' é¦–' : 'å…± ' + totalCount + ' æ¡')}}
          </view>
        </view>
        
        <block wx:for="{{searchResults}}" wx:key="id">
          <view 
            class="result-card" 
            bindtap="navigateToDetail"
            data-id="{{item.id}}" 
          >
            <text class="title">{{item.name}}</text>
            <view class="info-row">
              <text class="author">ä½œè€…: {{item.author || 'æœªçŸ¥'}}</text>
              <text class="dynasty">{{item.dynasty || 'ä¸è¯¦'}}</text>
            </view>
            <text class="content">{{item.fullAncientContent}}</text>
          </view>
        </block>
      </block>
    </block>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <view class="bottom-spacer"></view>
  </scroll-view>
  
  <!-- åˆ†é¡µå·¥å…·æ  -->
  <view class="pagination-container" wx:if="{{totalCount > 0}}">
    <!-- åˆ†é¡µæ§åˆ¶åŒºåŸŸ -->
    <view class="pagination-controls">
      <!-- å·¦ç®­å¤´ -->
      <view 
        class="pagination-arrow {{currentPage === 1 ? 'disabled' : ''}}" 
        bindtap="goToPrevPage"
      >
        <image src="https://newlan.oss-cn-shanghai.aliyuncs.com/icons/%E5%B7%A6%E7%AE%AD%E5%A4%B4.jpg" class="arrow-icon" mode="aspectFit" />
      </view>
      
      <!-- å½“å‰é¡µç æ˜¾ç¤º -->
      <view class="page-current-container">
        <text>{{currentPage}}</text>
      </view>
      
      <!-- å³ç®­å¤´ -->
      <view 
        class="pagination-arrow {{currentPage === totalPages ? 'disabled' : ''}}" 
        bindtap="goToNextPage"
      >
        <image src="https://newlan.oss-cn-shanghai.aliyuncs.com/icons/%E5%8F%B3%E7%AE%AD%E5%A4%B4.jpg" class="arrow-icon" mode="aspectFit" />
      </view>
      
      <!-- è½¬åˆ°åŒºåŸŸ -->
      <view class="goto-group">
        <text class="goto-label">è½¬åˆ°</text>
        <input 
          class="goto-input" 
          type="number" 
          placeholder="é¡µç " 
          value="{{gotoPage}}"
          bindinput="onGotoInput"
        />
        <!-- è·³è½¬æŒ‰é’® -->
        <button class="goto-button" bindtap="goToSpecifiedPage">è·³è½¬</button>
      </view>
    </view>
  </view>
  
  <!-- è¿”å›é¦–é¡µæŒ‰é’® -->
  <view class="float-nav-tool" bindtap="navigateToIndex">
    <text class="float-nav-icon">ğŸ </text>
  </view>
</view>